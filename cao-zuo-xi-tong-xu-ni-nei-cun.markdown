---
title: 操作系统虚拟内存
date: 2021-01-30 13:24:58
tags:
- os
---

为什么需要虚拟内存

1. 现代操作系统会运行多个进程, 各个进程的运行内存空间应该是隔离的, 不允许访问其他进程的内存空间, **地址隔离**
2. 软件运行需要指令和数据, 这些指令和数据所在的内存地址是不固定的, 否则不具备可移植性, **地址独立**
3. 物理内存空间有限, 而不同软件运行所需的内存空间是不确定的, **内存扩展**
4. 可以为不同的进程共享内存空间
5. 操作系统可以为不同的进程分配不连续的物理内存空间, 减少内存碎片

### 虚拟内存如何隔离各个进程

操作系统以页的方式管理内存, 每个进程内部会维护一个多级页表存储虚拟内存到物理内存的映射, 通过mmu内存管理单元为进程分配内存

### 虚拟内存如何扩展实际物理内存

在分页系统下, 进程需要的所有页面并不一定全都在内存中, 因此当访问的页面不在内存中时(通过页面的标志位判断是否在内存), 则发生**缺页中断**, 缺页中断服务负责将磁盘上的数据加载到内存中来, 这时如果物理内存已经没有空闲页面, 那么将发生**页面交换**

被交换出去的页面在不久又会被再次访问, 会发生**内存抖动**现象(频繁从磁盘读取数据), 因此需要合适的页面交换算法减少内存抖动, 常用的页面交换算法:

1. 随机算法
2. 先来先出算法
3. LRU算法
4. NRU算法(not recently used. 最近未使用算法)

参考
[<<操作系统之哲学原理>>](https://book.douban.com/subject/10528447/)
